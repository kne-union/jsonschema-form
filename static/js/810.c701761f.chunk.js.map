{"version":3,"file":"static/js/810.c701761f.chunk.js","mappings":"+KAMe,WAA2B,QAAAA,EAAAC,UAAAC,OAAPC,EAAO,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAPF,EAAOE,GAAAJ,UAAAI,GACtC,OAAqB,IAAjBF,EAAMD,OACC,SAAAI,GAAG,OAAIA,CAAJ,EAGO,IAAjBH,EAAMD,OACCC,EAAM,GAGVA,EAAMI,QAAO,SAACC,EAAGC,GAAJ,OAAU,kBAAaD,EAAEC,EAACC,WAAD,EAAAT,WAAf,CAAV,GACvB,C,qdCdM,MAAMU,EAAS,CACpBC,aAAc,KACdC,YAAcC,GAAsBC,GAAUC,IAAAA,cAACF,EAAqBC,IAGzDE,EAAUC,GACdC,OAAOC,OAAOT,EAAQO,G,sFCFzBG,EAAYP,GACTQ,IAA8D,IAA7D,SAAEC,EAAQ,UAAEC,EAAS,OAAEC,EAAM,QAAEC,EAAO,KAAEC,GAAgBL,EAAPP,EAAKa,EAAAN,EAAAO,GAC5D,MAAOC,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IACvCC,EAAAA,EAAAA,qBAAoBR,GAAQ,KACnB,CACLS,MAAOA,IAAMH,GAAW,GAAQA,aAAYD,aAE7C,CAACA,EAASC,IAEb,MAAMI,ECba,SAACC,GAA+B,IAArBC,EAAQpC,UAAAC,OAAA,QAAAoC,IAAArC,UAAA,IAAAA,UAAA,GACxC,MAAMsC,GAAcC,EAAAA,EAAAA,QAAOJ,GAI3B,OAHKC,IACHE,EAAYE,QAAUL,IAEjBM,EAAAA,EAAAA,cAAY,WACjB,OAAOH,EAAYE,SAAWF,EAAYE,WAAQxC,U,GACjD,GACJ,CDKiB0C,CAAejB,GAO7B,OALAkB,EAAAA,EAAAA,YAAU,KACRT,IACAJ,GAAW,EAAK,GACf,CAACI,IAEInB,IAAAA,cAACF,EAAgB+B,EAAA,GACnB9B,EAAK,CACT+B,KAAMhB,EACNI,MAAOA,IAAMH,GAAW,GACxBJ,KAAMoB,UACJ,IAAKpB,EAEH,YADAI,GAAW,IAID,UADMJ,KAEhBI,GAAW,EACb,EAEFR,SAAU,WACRQ,GAAW,GACXR,GAAYA,KAAStB,U,EAEvB+C,WAAYxB,IACZ,EAIAyB,EAAkBnC,IACtB,MAAMoC,GAAMC,EAAAA,EAAAA,WAAU,MACtB,OAAQC,IACN,MAAMC,EAAO1C,EAAOC,cAAgBD,EAAOC,gBAAkB0C,SAASD,KAChEE,EAAOD,SAASE,cAAc,OACYC,EAAAtC,OAAOC,OAAO,CAAC,EAAGgC,IAA5D,YAAEvC,EAAW,aAAED,GAAwB6C,EAAP1C,EAAKa,EAAA6B,EAAAC,GAC3CL,EAAKM,YAAYJ,GACjB,MAAMK,EAAUC,EAAAA,WAAoBN,GAC9BO,EAAU,IAAIC,SAASC,IAC3B,MAAMC,GAAgBC,EAAAA,EAAAA,GAAQ7C,EAAWV,EAAOE,YAA1BqD,CAA8D,oBAAhBrD,EAA6BA,EAAYC,GAAoBA,GACjI8C,EAAQO,OAAOnD,IAAAA,cAACiD,EAAapB,EAAA,CAC3BpB,OAAQyB,GACJnC,EAAK,CACTH,aAAcA,GAAgB,KAAO2C,GACrC/B,UAAWA,KACT+B,EAAKa,MAAMC,QAAU,IACrBhB,EAAKiB,YAAYf,GACjBgB,YAAW,KACTX,EAAQY,SAAS,GAChB,EAAE,EAEP9C,QAASA,KACPsC,EAAQ,CACN9B,MAAOgB,EAAIT,QAAQP,OACnB,KAEH,IAGCA,EAAQA,IACL4B,EAAQW,MAAKC,IAAe,IAAd,MAAExC,GAAOwC,EAC5BxC,GAAO,IAGX,MAAO,CACLA,QAAOO,QAAS,CAAEP,SACnB,CACF,C,kBEhFH,IAAIyC,EAAIC,EAAQ,OAEdC,EAAQC,WAAaH,EAAEG,WACvBD,EAAQE,YAAcJ,EAAEI,W","sources":["../../node_modules/@kne/compose/src/index.js","../../node_modules/@kne/with-layer/src/preset.js","../../node_modules/@kne/with-layer/src/index.js","../../node_modules/@kne/use-ref-callback/src/index.js","../../node_modules/react-dom/client.js"],"sourcesContent":["/**\n * @name: compose ;\n * @author: linzp ;\n * @description: 实现方法的调用串联 ;\n * */\n\nexport default function compose(...funcs) {\n    if (funcs.length === 0) {\n        return arg => arg\n    }\n\n    if (funcs.length === 1) {\n        return funcs[0]\n    }\n\n    return funcs.reduce((a, b) => (...args) => a(b(...args)))\n}","import React from \"react\";\r\n\r\nexport const global = {\r\n  getContainer: null,\r\n  withInstall: (WrappedComponent) => (props) => <WrappedComponent {...props} />\r\n};\r\n\r\nexport const preset = (options) => {\r\n  return Object.assign(global, options);\r\n};\r\n\r\nexport default preset;\r\n","import ReactDOM from \"react-dom/client\";\r\nimport compose from \"@kne/compose\";\r\nimport React, { createRef, useState, useImperativeHandle, useEffect } from \"react\";\r\nimport useRefCallback from \"@kne/use-ref-callback\";\r\nimport { global } from \"./preset\";\r\n\r\nconst withLayer = WrappedComponent => {\r\n  return ({ onCancel, onDestroy, outRef, onMount, onOk, ...props }) => {\r\n    const [visible, setVisible] = useState(false);\r\n    useImperativeHandle(outRef, () => {\r\n      return {\r\n        close: () => setVisible(false), setVisible, visible\r\n      };\r\n    }, [visible, setVisible]);\r\n\r\n    const mount = useRefCallback(onMount);\r\n\r\n    useEffect(() => {\r\n      mount();\r\n      setVisible(true);\r\n    }, [mount]);\r\n\r\n    return (<WrappedComponent\r\n      {...props}\r\n      open={visible}\r\n      close={() => setVisible(false)}\r\n      onOk={async () => {\r\n        if (!onOk) {\r\n          setVisible(false);\r\n          return;\r\n        }\r\n        const res = await onOk();\r\n        if (res !== false) {\r\n          setVisible(false);\r\n        }\r\n      }}\r\n      onCancel={(...args) => {\r\n        setVisible(false);\r\n        onCancel && onCancel(...args);\r\n      }}\r\n      afterClose={onDestroy}\r\n    />);\r\n  };\r\n};\r\n\r\nconst createWithLayer = WrappedComponent => {\r\n  const ref = createRef(null);\r\n  return (args) => {\r\n    const body = global.getContainer && global.getContainer() || document.body;\r\n    const root = document.createElement(\"div\");\r\n    const { withInstall, getContainer, ...props } = Object.assign({}, args);\r\n    body.appendChild(root);\r\n    const rootDom = ReactDOM.createRoot(root);\r\n    const promise = new Promise((resolve) => {\r\n      const LayerInstance = compose(withLayer, global.withInstall)(typeof withInstall === \"function\" ? withInstall(WrappedComponent) : WrappedComponent);\r\n      rootDom.render(<LayerInstance\r\n        outRef={ref}\r\n        {...props}\r\n        getContainer={getContainer || (() => root)}\r\n        onDestroy={() => {\r\n          root.style.opacity = \"0\";\r\n          body.removeChild(root);\r\n          setTimeout(() => {\r\n            rootDom.unmount();\r\n          }, 0);\r\n        }}\r\n        onMount={() => {\r\n          resolve({\r\n            close: ref.current.close\r\n          });\r\n        }}\r\n      />);\r\n    });\r\n\r\n    const close = () => {\r\n      return promise.then(({ close }) => {\r\n        close();\r\n      });\r\n    };\r\n    return {\r\n      close, current: { close }\r\n    };\r\n  };\r\n};\r\n\r\nexport default createWithLayer;\r\nexport { preset } from \"./preset\";\r\n","import { useRef, useCallback } from \"react\";\n\nconst useRefCallback = (callback, keepInit = false) => {\n  const callbackRef = useRef(callback);\n  if (!keepInit) {\n    callbackRef.current = callback;\n  }\n  return useCallback((...args) => {\n    return callbackRef.current && callbackRef.current(...args);\n  }, []);\n};\n\nexport default useRefCallback;\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n"],"names":["_len","arguments","length","funcs","Array","_key","arg","reduce","a","b","apply","global","getContainer","withInstall","WrappedComponent","props","React","preset","options","Object","assign","withLayer","_ref","onCancel","onDestroy","outRef","onMount","onOk","_objectWithoutPropertiesLoose","_excluded","visible","setVisible","useState","useImperativeHandle","close","mount","callback","keepInit","undefined","callbackRef","useRef","current","useCallback","useRefCallback","useEffect","_extends","open","async","afterClose","createWithLayer","ref","createRef","args","body","document","root","createElement","_Object$assign","_excluded2","appendChild","rootDom","ReactDOM","promise","Promise","resolve","LayerInstance","compose","render","style","opacity","removeChild","setTimeout","unmount","then","_ref2","m","require","exports","createRoot","hydrateRoot"],"sourceRoot":""}